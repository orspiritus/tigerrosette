```
🎮⚔️ СИСТЕМА ЗАЯВОК НА ДУЭЛЬ - TigerRozetka

┌─────────────────────────────────────────────────────────────────────────────┐
│                           ОТПРАВКА ЗАЯВКИ                                   │
├─────────────────────────────────────────────────────────────────────────────┤
│  1. 👤 Игрок A                                                             │
│     ├─ Нажимает "⚔️ Дуэль"                                                 │
│     ├─ Открывается DuelInviteScreen                                       │
│     ├─ Загружаются контакты Telegram                                      │
│     └─ Выбирает соперника Игрока B                                        │
│                                                                             │
│  2. 📩 Формирование приглашения                                             │
│     ├─ ID: duel_${timestamp}_${userA}_${userB}                            │
│     ├─ Сообщение: "🎮⚔️ ДУЭЛЬ TIGERROZETKA!"                              │
│     ├─ Отправитель: ${name} (Уровень ${level})                            │
│     └─ Время жизни: 5 минут                                               │
│                                                                             │
│  3. ⚡ Отправка через Telegram                                              │
│     ├─ webApp.sendData(inviteData)                                        │
│     ├─ Локальное сохранение в pendingInvites                              │
│     └─ Статус: "Ожидание ответа..."                                       │
└─────────────────────────────────────────────────────────────────────────────┘

                                    ↓ ↓ ↓

┌─────────────────────────────────────────────────────────────────────────────┐
│                          ПОЛУЧЕНИЕ ЗАЯВКИ                                   │
├─────────────────────────────────────────────────────────────────────────────┤
│  1. 📱 Игрок B                                                             │
│     ├─ DuelInviteReceiver слушает события                                 │
│     ├─ Получает уведомление от Telegram                                   │
│     ├─ Показывается pop-up с приглашением                                 │
│     └─ webApp.showAlert("Новое приглашение!")                             │
│                                                                             │
│  2. 🎯 Выбор ответа                                                        │
│     ├─ ✅ Кнопка "Принять дуэль"                                           │
│     ├─ ❌ Кнопка "Отклонить"                                               │
│     ├─ ⏰ Автоистечение через 5 минут                                      │
│     └─ 📳 Вибрация hapticManager.heavy()                                  │
│                                                                             │
│  3. 📤 Отправка ответа                                                     │
│     ├─ webApp.sendData({type: 'duel_response'})                           │
│     ├─ response: 'accepted' | 'declined'                                  │
│     └─ inviteId для связи с заявкой                                       │
└─────────────────────────────────────────────────────────────────────────────┘

                                    ↓ ↓ ↓

┌─────────────────────────────────────────────────────────────────────────────┐
│                         ЗАПУСК ДУЭЛИ                                        │
├─────────────────────────────────────────────────────────────────────────────┤
│  ✅ Если принято:                                                          │
│     ├─ Игрок A: получает уведомление о принятии                           │
│     ├─ Игрок B: автоматически переходит в режим дуэли                     │
│     ├─ Оба: startRealDuel() → gameState.mode = 'duel'                     │
│     └─ Открывается DuelScreen для обоих игроков                           │
│                                                                             │
│  ❌ Если отклонено:                                                        │
│     ├─ Игрок A: "Приглашение отклонено"                                   │
│     ├─ Игрок B: приглашение удаляется                                     │
│     └─ Возврат в главное меню                                             │
│                                                                             │
│  ⏰ Если истекло время:                                                    │
│     ├─ Автоматическое удаление из обеих очередей                          │
│     ├─ Уведомление: "Время ожидания истекло"                              │
│     └─ Возврат в меню                                                     │
└─────────────────────────────────────────────────────────────────────────────┘

                                    ↓ ↓ ↓

┌─────────────────────────────────────────────────────────────────────────────┐
│                        РЕАЛЬНАЯ ДУЭЛЬ                                       │
├─────────────────────────────────────────────────────────────────────────────┤
│  🎮 DuelScreen.tsx                                                         │
│     ├─ ⏱️  60-секундный таймер                                             │
│     ├─ 🔥 Live счетчики очков для обоих игроков                           │
│     ├─ ⚡ 25% шанс удара током при клике                                   │
│     ├─ 📊 Real-time синхронизация через WebSocket                         │
│     └─ 🏆 Автоматическое определение победителя                           │
│                                                                             │
│  📡 useDuelConnection.ts                                                   │
│     ├─ WebSocket симуляция (готова к real backend)                        │
│     ├─ Обмен сообщениями между игроками                                   │
│     ├─ Синхронизация действий и счета                                     │
│     └─ Обработка отключений и ошибок                                      │
│                                                                             │
│  🎯 Результат                                                              │
│     ├─ Подсчет финального счета                                           │
│     ├─ Показ победителя/проигравшего                                      │
│     ├─ Начисление опыта и вольт                                           │
│     └─ Возможность реванша                                                │
└─────────────────────────────────────────────────────────────────────────────┘

🔧 ТЕХНИЧЕСКАЯ РЕАЛИЗАЦИЯ:
├─ Frontend: React + TypeScript + Framer Motion
├─ Telegram: Mini Apps SDK + WebApp API
├─ Backend: Node.js + Express + Socket.IO (готов)
├─ Database: SQLite + Prisma ORM
└─ Real-time: WebSocket симуляция → Socket.IO

🎮 ТЕСТИРОВАНИЕ:
├─ Локально: http://localhost:5173/
├─ Telegram: https://orspiritus.github.io/tigerrosette/  
├─ URL параметр: ?duel_invite=test123
└─ Команды: ./start-all.ps1
```
